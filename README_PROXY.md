# Настройка прокси для Gemini API

## Проблема
Из России Gemini API возвращает ошибку: `User location is not supported for the API use.`

## Решение
Используется прокси-сервер, который работает на бэкенде и может использовать VPN или прокси для обхода географических ограничений.

## Установка зависимостей

```bash
npm install
```

## Запуск

### Вариант 1: Запуск прокси и dev-сервера отдельно

1. В первом терминале запустите прокси-сервер:
```bash
npm run dev:proxy
```

2. Во втором терминале запустите dev-сервер:
```bash
npm run dev
```

### Вариант 2: Запуск вместе (рекомендуется)

```bash
npm run dev:all
```

Это запустит оба сервера одновременно через `concurrently`.

## Настройка

1. Убедитесь, что в `.env.local` есть:
```env
GEMINI_API_KEY=ваш_ключ_здесь

# Порт сервера прокси (по умолчанию 3001)
PROXY_SERVER_PORT=3001

# Настройки прокси для обхода геолокации (опционально, по умолчанию используются встроенные значения)
PROXY_HOST=139.177.145.55
PROXY_PORT=1402
PROXY_USER=user287404
PROXY_PASS=4sxapj
```

2. Настройка URL прокси в приложении:
   - По умолчанию используется `http://localhost:3001`
   - Можно изменить через переменную `VITE_PROXY_URL` в `.env.local`:
   ```env
   VITE_PROXY_URL=http://localhost:3001
   ```

## Прокси настроен

Прокси-сервер уже настроен с предоставленными учетными данными:
- **IP**: 139.177.145.55
- **Port**: 1402
- **Login**: user287404
- **Password**: 4sxapj

Эти значения можно переопределить через переменные окружения в `.env.local`.

## Использование прокси через VPN

Если нужно использовать VPN на сервере для проксирования запросов, можно:

1. Настроить системный VPN на сервере, где запущен прокси
2. Или использовать SOCKS5/HTTP прокси - для этого нужно установить `https-proxy-agent` и изменить `server/proxy.js`

## Production

В production нужно:
1. Задеплоить прокси-сервер на сервер с доступом к VPN или прокси
2. Установить переменную окружения `VITE_PROXY_URL` на URL вашего прокси-сервера
3. Настроить CORS на прокси-сервере для вашего домена

